# ==Part I：背景与统一形式化==

## 第1章：引言与贡献概览

### 1.1. 背景与动机

量子 Born 机（QCBM）利用参数化量子态 $|\psi_\theta\rangle$ 的计算基测量来建模概率分布：$p_\theta(x)=|\psi_\theta(x)|^2$。当 $|\psi_\theta\rangle$ 顺序化为矩阵乘积态（MPS）时，键维 $D$（纠缠度量）决定了模型的表达能力。然而，由于纠缠结构和振幅-相位的耦合，系统地将 $D$ 与可学习性（样本复杂度、稳定性）联系起来仍具挑战。

本工作提出一个以 **Hankel 矩阵**为核心的统一框架来分析序列可学习性。给定 MPS 表示：

$$
\psi_\theta(x)=\alpha^\top\!\Big(\prod_{t=1}^T A_t(x_t)\Big)\beta,
$$

我们定义振幅 Hankel 矩阵 $H_a(u,v)=\psi_\theta(uv)$ 和概率 Hankel 矩阵 $H_p(u,v)=|H_a(u,v)|^2$。关键的结构约束是：

$$
\operatorname{rank}(H_a)\le D,\qquad \operatorname{rank}(H_p)\le D^2.
$$

我们利用这一低秩结构将 QCBM 的学习纳入加权有限自动机（WFA）的范式。$H_p$ 的谱性质（秩、条件数）直接决定了底层有限维线性表示的可辨识性和统计效率。

### 1.2. 主要贡献

本工作提供了一个将 QCBM 结构与其可学习性联系起来的全面理论：

*   **结构统一（Born–Hankel–自动机）**：确立了**转移算子** $T=\sum_{\sigma\in\Sigma}A(\sigma)\otimes\overline{A(\sigma)}$ 的核心作用。$T$ 连接了 MPS 规范化与 $H_p$ 的线性化；其谱性质（如在规范形下的谱半径和不动点）控制着长度依赖性和渐近行为。
*   **秩、稳定性与稳健性**：证明了 $\operatorname{rank}(H_p)\le D^2$，并在 MPS 截断下推导了 $\|H_p-\tilde H_p\|_2$ 的界。误差传播由**几何放大因子** $G_L(\kappa_p)$ 控制。我们还证明了 $D^2$ 界的近紧性。
*   **可辨识性与最小实现**：利用可观测/可控制子空间，我们证明了 Hankel 秩与最小实现维度的等价性。我们通过限制 Gram 矩阵给出了 $\sigma_{\min}$ 的下界，并区分了 gauge 等价类与可识别不变量。
*   **统计学习理论**：我们为 one-shot 和滑窗采样建立了经验 Hankel 估计的集中不等式（矩阵 Bernstein/Freedman）。在核范数/有效秩约束下推导了泛化界。端到端误差分析表明，长度依赖性在可收缩锥内可从 $G_L(\kappa_B)$ 降至 $O(L)$。

---

## 第2章：记号、模型与预备知识

### 2.1. 记号与定义

*   **序列**：有限字母表 $\Sigma$ ($|\Sigma|=d$)。$\Sigma^L$ 表示长度为 $L$ 的字符串；$uv$ 表示连接。
*   **Hankel 矩阵**：对于函数 $f:\Sigma^L\to\mathbb C$（或 $\mathbb R_{\ge0}$），长度-$L$ Hankel 矩阵定义为 $H_f^{(L)}(u,v)=f(uv)$，仅索引满足 $|u|+|v|=L$ 的 $(u,v)$ 对。$H_f^{(L)}(P,S)$ 表示由前缀集 $P$ 和后缀集 $S$ 索引的子矩阵。
*   **线性代数**：$\otimes$（Kronecker 积），$(\cdot)^\dagger$（共轭转置）。$\|\cdot\|_2$（谱范数）。$\mathrm{vec}(\cdot)$（列优先向量化）。关键恒等式：$\mathrm{vec}(AXB)=(B^\top\!\otimes A)\,\mathrm{vec}(X)$。

### 2.2. Born 机与 MPS 形式化

*   **QCBM**：模型生成分布 $p_\theta(x)=|\psi_\theta(x)|^2$，满足 $\sum_x p_\theta(x)=1$。
*   **MPS 表示**：我们假设一个顺序分解（MPS）：

$$
\psi_\theta(x_{1:L})=\alpha^\top\!\Big(\prod_{t=1}^L A_t(x_t)\Big)\beta,
$$

其中 $A_t(\sigma)\in\mathbb C^{D\times D}$，$\alpha,\beta\in\mathbb C^D$。
*   **Gauge 自由度**：实现对于 gauge 变换 $A'(\sigma)=S^{-1}A(\sigma)S$（及相应的 $\alpha, \beta$ 变换）是不变的。
*   **规范形**：诸如左规范（$\sum_\sigma A(\sigma)A(\sigma)^\dagger=I$）等约束固定了 gauge 并确保数值稳定性。

### 2.3. Hankel 结构与线性化

MPS 与 WFA 的联系通过 Hankel 结构实现。

##### 振幅 Hankel ($H_a$)，定义前缀和后缀嵌入：

$$
\ell(u)=\Big(\prod_{t=1}^{|u|}A(u_t)\Big)^\top\!\alpha,\qquad
r(v)=\Big(\prod_{t=1}^{|v|}A(v_t)\Big)\beta.
$$

则 $H_a(u,v)=\ell(u)^\top r(v)$，蕴含 $\operatorname{rank}(H_a)\le D$。

##### 概率 Hankel ($H_p$) 与 WFA 动力学

我们使用 Kronecker 嵌入来线性化 $H_p$：
$$
\ell_p(u)=\ell(u)\otimes\overline{\ell(u)},\qquad
r_p(v)=r(v)\otimes\overline{r(v)}.
$$

则 $H_p(u,v)=\ell_p(u)^\top r_p(v)$，蕴含 $\operatorname{rank}(H_p)\le D^2$。动力学由线性算子（WFA 转移矩阵）控制：

$$
B_\sigma:=A(\sigma)\otimes\overline{A(\sigma)}\in\mathbb C^{D^2\times D^2}.
$$

传播是严格线性的：$\ell_p(u\sigma)^\top=\ell_p(u)^\top B_\sigma$ 且 $r_p(\sigma v)=B_\sigma\,r_p(v)$。

### 2.4. 采样与估计

我们分析在独立同分布（one-shot）样本 $x^{(i)}\sim p_\theta$ 或相关（滑窗）样本下的估计。经验 Hankel 矩阵 $\widehat H_p$ 通过前缀-后缀对的频数统计构建。误差通常通过总体变分距离（TV）或泛化间隙来衡量。若采用量子访问（如 QAE），可进一步缩小方差，但本文主体结果不依赖于此。

---

## 第3章：Born–Hankel–自动机的统一视角

本章将 QCBM 的概率结构与加权有限自动机（WFA）/有理级数理论对齐。核心分析工具是转移算子 $T$ 及其谱性质，它连接了 MPS 的物理属性与 Hankel 矩阵的代数结构。

### 3.1. 转移算子、Liouville 表示与谱性质

我们关注 MPS 诱导的完全正（CP）映射 $E(X)=\sum_{\sigma}A(\sigma)XA(\sigma)^\dagger$ 及其向量化表示。

##### 定义 3.1（Liouville 矩阵与转移算子）

CP 映射 $E$ 的 **Liouville 矩阵** $\mathcal L$ 满足 $\mathrm{vec}(E(X))=\mathcal L\,\mathrm{vec}(X)$：

$$
\mathcal L\ :=\ \sum_{\sigma}\overline{A(\sigma)}\otimes A(\sigma).
$$

我们同时定义 WFA 的字母转移矩阵 $B_\sigma:=A(\sigma)\otimes \overline{A(\sigma)}$ 和**总转移算子**：

$$
T\ :=\ \sum_{\sigma}B_\sigma\in\mathbb C^{D^2\times D^2}.
$$

$\mathcal L$ 与 $T$ 通过换位矩阵 $K$ **相似等价**（$\mathcal L=K\,T\,K^{-1}$），因此具有相同的谱。

##### 命题 3.2（规范化与谱控制）

MPS 的规范化选择直接控制 $T$ 的谱性质：

1.  **左规范**（$\sum_{\sigma}A(\sigma)A(\sigma)^\dagger=I$）等价于 $E(I)=I$（Unital CP map）。这蕴含 $T\,\mathrm{vec}(I)=\mathrm{vec}(I)$，故 $1\in\mathrm{spec}(T)$。
2.  在左规范下，由算子范数性质（Russo–Dye/Kadison），$\|E\|_{\infty\to\infty}=1$，因此谱半径 $\rho(T)=1$。其对偶映射 $E^*$ 是迹保持的（CPTP）。
3.  若 $E$ 是**原始的（primitive）**，则 $1$ 是唯一的、简单的外围特征值，其余特征值满足 $|\lambda|<1$。这保证了系统向唯一稳态的收敛（存在谱隙）。

##### 命题 3.3（Hankel 分解回顾）

概率 Hankel $H_p$ 通过 Kronecker 嵌入 $\ell_p(u), r_p(v)$ 实现双线性分解，其动力学由 $B_\sigma$ 线性控制（$\ell_p(u\sigma)^\top=\ell_p(u)^\top B_\sigma$）。定义可观测矩阵 $O_P[u,:]=\ell_p(u)^\top$ 和可控制矩阵 $C_S[:,v]=r_p(v)$，则 $H_p(P,S)=O_P\,C_S$，且 $\operatorname{rank}(H_p)\le D^2$。

### 3.2. WFA 实现理论与可辨识性

QCBM 的概率分布 $p(x)$ 可以被精确地表示为一个 WFA（线性表示） $(i,\{B_\sigma\},f)$：

$$
p(x)=i^\top B_{x_1}\cdots B_{x_L} f,
$$

其中 $i=\alpha\otimes\overline{\alpha}$, $f=\beta\otimes\overline{\beta}$。

##### 定义 3.4（可观测与可控制子空间）

定义系统的可观测空间 $\mathcal O:=\operatorname{span}\{i^\top B_u\}$ 和可控制空间 $\mathcal C:=\operatorname{span}\{B_v f\}$。Hankel 矩阵的行空间包含于 $\mathcal O$，列空间包含于 $\mathcal C$。

##### 定理 3.5（最小实现定理）

（实现论的基本定理）函数 $h$ 的（无限）Hankel 矩阵 $H_h$ 的秩 $r=\operatorname{rank}(H_h)$ 恰好等于其**最小线性表示的维度**。

*注：* 对于有限长度 $L$，必须使用**块-Hankel** $H_h^{(\le L)}$（索引所有 $|u|+|v|\le L$）来保证存在一组一致的 $\{B_\sigma\}$ 再现所有长度 $\le L$ 的值。仅用单层 $H_h^{(L)}$ 是不充分的。

##### 推论 3.6（结构可辨识性）

若一个表示是最小的（维度为 $r$），则它在相似变换下是唯一的。任意两个最小表示 $(i,B,f)$ 和 $(i',B',f')$ 之间存在唯一可逆矩阵 $Q\in \mathrm{GL}(r)$ 使得 $B'_\sigma=Q^{-1}B_\sigma Q$（以及 $i'^\top=i^\top Q, f'=Q^{-1}f$）。

### 3.3. Gauge 不变性与稳定性判据

MPS 的 gauge 变换 $A'(\sigma)=S^{-1}A(\sigma)S$ 在 WFA 层面诱导相似变换，其中 $Q=S\otimes\overline S$。$p(x)$ 和 $\operatorname{rank}(H_p)$ 是 gauge 不变量，但条件数依赖于坐标选择。我们引入关键的稳定性工具。

需要特别区分的是：gauge/相似变换作用在物理转移算子 $B_\sigma$ 上保持其谱不变；而后文的 Hankel 白化则是作用在 $H_p(P,S)$ 的低秩子空间上，构造一组新的等价表示 ${\widehat B_\sigma}$，其和为 $I_r$ 只是这一表示下的规范化选择。

##### 定理 3.7（稳定性判据与恒等校准）

**设定**：$H=H_p(P,S)=O_P C_S$，$\operatorname{rank}(H)=r$。令 $U$ 为 $\operatorname{col}(C_S)$ 的正交基。定义限制 Gram 矩阵：$\mathcal O_P:=U^\dagger O_P^\dagger O_P\,U$ 和 $\mathcal C_S:=U^\dagger C_S C_S^\dagger U$。

##### (A) 限制-Gram 下界（稳定性）

Hankel 矩阵的最小非零奇异值满足：
$$
\boxed{\quad
\sigma_r(H)\ \ge\ \sqrt{\lambda_{\min}(\mathcal O_P)}\ \sqrt{\lambda_{r}(\mathcal C_S)}\ .
\quad}
$$

这为选择能保证数值稳定性的 $P,S$ 提供了依据。

##### (B) 恒等校准（WFA 白化）

设 $H=U_r\Sigma_r V_r^\dagger$ 为秩-$r$ SVD。通过构造（详见原文）可逆矩阵 $W_L, W_R$，我们可以在秩-$r$ 子空间上实现精确的白化和归一化：
$$
\boxed{\quad W_LHW_R=I_r.\quad}
$$

令 $\widehat B_\sigma:=W_LH_\sigma W_R$（其中 $H_\sigma$ 是按后缀首字母划分的子块），则自动满足：

$$
\boxed{\quad \sum_{\sigma\in\Sigma}\widehat B_\sigma=I_r.\quad}
$$

这定义了一个数据驱动的规范坐标系，其中平均转移效应被规约为恒等映射，有助于稳定学习过程。

需要强调的是，这里的 $\widehat B_\sigma$ 是由 Hankel 分解得到的“数据驱动有效转移矩阵”，一般并不与物理 Liouville 转移算子 $B_\sigma$ 通过单一相似变换相连；因此 $\sum_{\sigma}\widehat B_\sigma = I_r$ 仅是这一坐标选择下的规范化性质，而不是对原始 $T=\sum_\sigma B_\sigma$ 的谱约束。

---

# ==Part II：结构理论==

## 第4章：秩—纠缠理论与有效维数

> **约定：** 长度-$L$ Hankel 矩阵 $H(u,v)$ 仅索引满足 $|u|+|v|=L$ 的 $(u,v)$。

### 4.1. 秩上界与纠缠

QCBM 的核心结构特征源于其底层 MPS 表示的有限键维 $D$。这直接限制了 Hankel 矩阵的秩。

##### 定理 4.1（基本秩界）

给定键维为 $D$ 的 MPS 表示，其振幅 Hankel 矩阵 $H_a$ 和概率 Hankel 矩阵 $H_p$ 满足：

$$
\operatorname{rank}(H_a)\le D,\qquad \operatorname{rank}(H_p)\le D^2.
$$

**证明概要：** $H_a$ 的秩界源于其双线性分解 $H_a(u,v)=\ell(u)^\top r(v)$，其中嵌入向量 $\ell(u), r(v) \in \mathbb{C}^D$。$H_p$ 的秩界源于 Kronecker 嵌入 $\ell_p(u)=\ell(u)\otimes\overline{\ell(u)} \in \mathbb{C}^{D^2}$，使得 $H_p$ 可以被分解为 $D^2$ 维的双线性形式。

该分解同时确立了 WFA 的线性动力学，由算子 $B_\sigma=A(\sigma)\otimes\overline{A(\sigma)}$ 控制嵌入向量的传播（见 §2.3）。

### 4.2. 有效秩与截断稳定性

在实际中，高维 MPS 常常可以被低维 MPS 有效近似，对应于快速衰减的纠缠谱。我们分析这种近似对 Hankel 矩阵谱结构的影响。

**设定：** 考虑在 MPS 的每个割点进行最优秩-$D_{\rm eff}$ 截断。令 $\epsilon_t^2$ 为第 $t$ 个割点处被截断的 Schmidt 权重的平方和（尾能量）。记 $\tilde\psi$ 和 $\tilde H_p$ 为截断后的态和 Hankel 矩阵。

##### 定理 4.2（截断误差传递）

假设采用标准 MPS 规范形和逐割最优截断。全局态误差满足（MPS rounding 引理）：

$$
\|\psi-\tilde\psi\|_2\ \le\ \Big(\sum_{t=1}^{L-1}\epsilon_t^2\Big)^{\!1/2}.
$$

对于归一化的态，该误差传递到概率 Hankel 矩阵的谱范数误差：

$$
\boxed{\ \ \|H_p-\tilde H_p\|_2\ \le\ 2\,\|\psi-\tilde\psi\|_2\ \le\ 2\Big(\sum_{t=1}^{L-1}\epsilon_t^2\Big)^{\!1/2}\ :=\ \Delta_H.\ }
$$

**证明概要：** 利用范数不等式 $\|H_p-\tilde H_p\|_2 \le \|H_p-\tilde H_p\|_F = \||\psi|^2-|\tilde\psi|^2\|_2$（当完整枚举该层时），以及 $\||\psi|^2-|\tilde\psi|^2\|_2 \le (\|\psi\|_2+\|\tilde\psi\|_2)\|\psi-\tilde\psi\|_2 = 2\|\psi-\tilde\psi\|_2$。

##### 推论 4.3（有效秩）

令 $\operatorname{rank}_\varepsilon(\cdot)$ 表示谱范数容差为 $\varepsilon$ 的有效秩。由于 $\operatorname{rank}(\tilde H_p)\le D_{\rm eff}^2$，由定理 4.2 可知：

$$
\boxed{\ \ \forall\,\varepsilon\ge \Delta_H,\qquad \operatorname{rank}_\varepsilon(H_p)\ \le\ D_{\rm eff}^2.\ }
$$

这表明，低纠缠（小的 $\Delta_H$）直接导致概率 Hankel 矩阵的低有效秩 $r_{\rm eff}$。

### 4.3. 秩的紧性与典型性

我们证明 $D^2$ 的上界是紧的，并且在一般情况下是达到的。

##### 定理 4.4（秩的近紧性与典型满秩）

给定键维 $D$ 和足够大的前缀/后缀集 $P, S$（$|P|, |S| \ge D^2$）。

1.  **（紧性）** 存在 MPS 参数使得 $\operatorname{rank} H_p(P,S)=D^2$。
2.  **（典型性）** 若 MPS 参数分布对于参数空间的 Lebesgue 测度（或 Haar 测度）是绝对连续的，则 $\operatorname{rank} H_p(P,S)=D^2$ 以概率 1 成立。

**证明概要：** $\operatorname{rank} H_p < D^2$ 等价于所有 $D^2\times D^2$ 子式的行列式为零。这些行列式是 MPS 参数的多项式。由于存在满秩实例（非零多项式），其零点集（低秩参数集）的测度为零（Zariski 闭集）。因此，在绝对连续分布下，满秩几乎必然发生。

**备注：** 这意味着“高纠缠/随机电路”通常导致满秩 Hankel。学习算法中的低秩假设本质上是对模型的**结构性约束**（如低纠缠或对称性），而非对典型行为的假设。注意，离散的精确设计（如 Clifford 群）不满足绝对连续性，不适用此结论。

---

## 第5章：稳定性与长度依赖

本章分析模型扰动（如 MPS 截断或门噪声）如何传播到概率 Hankel 矩阵 $H_p$。我们重点关注误差随系统长度 $L$ 的累积行为，并引入几何放大因子来量化这种依赖性。

### 5.1. MPS 截断的稳定性

我们首先考虑在标准 MPS 规范形下进行逐割最优秩截断的特殊情况。

**设定：** 令 $\epsilon_t^2$ 为第 $t$ 个割点的尾能量（被舍弃的 Schmidt 权重平方和）。$\psi$ 和 $\tilde\psi$ 分别表示原始态和截断态（均归一化）。

##### 命题 5.1（逐割截断的主界）

在上述设定下，概率 Hankel 矩阵的谱范数误差满足：

$$
\boxed{\;
\|H_p-\tilde H_p\|_2\ \le\ 2\Big(\sum_t \epsilon_t^2\Big)^{1/2}.
\;}
$$

**证明概要：** 该界源于范数不等式 $\|H_p-\tilde H_p\|_2 \le 2\|\psi-\tilde\psi\|_2$（定理 4.2）和 MPS rounding 引理 $\|\psi-\tilde\psi\|_2\le(\sum_t\epsilon_t^2)^{1/2}$。

此界表明，在规范形下，稳定性由总的纠缠尾能量直接控制，长度依赖性相对温和。

### 5.2. 一般扰动分析框架

对于一般扰动（如门噪声），我们采用算子扰动理论进行分析。

**设定与记号：** 考虑时变（非齐次）门列。令 $M_{t,\sigma}:=A_t(\sigma)\otimes \overline{A_t(\sigma)}$ 为第 $t$ 层的 WFA 转移矩阵，$\widetilde M_{t,\sigma}$ 为扰动后的版本。定义扰动 $\Delta_{t,\sigma}:=\widetilde M_{t,\sigma}-M_{t,\sigma}$。

我们定义关键控制参数（默认为谱范数 $\|\cdot\|_2$）：

*   **逐层传播常数：** $\kappa_{p,t}:=\max_{\sigma}\big\{\|M_{t,\sigma}\|_2,\ \|\widetilde M_{t,\sigma}\|_2\big\}$；$\kappa_p:=\max_t \kappa_{p,t}$。
*   **逐层扰动幅度：** $\epsilon_p(t):=\max_{\sigma}\|\Delta_{t,\sigma}\|_2$。

##### 引理 5.2（单步扰动界）

若 $\|A_t(\sigma)\|_2\le \kappa$ 且 $\|\widetilde A_t(\sigma)-A_t(\sigma)\|_2\le \varepsilon_t$，则 $\epsilon_p(t) \le 2\kappa\varepsilon_t + \varepsilon_t^2$。

##### 引理 5.3（望远镜恒等式）

误差传播的核心是乘积的望远镜展开。对任意串 $x\in\Sigma^L$：

$$
\prod_{t=1}^L \widetilde M_{t,x_t}-\prod_{t=1}^L M_{t,x_t}
=\sum_{s=1}^L\Big(\prod_{t=s+1}^L \widetilde M_{t,x_t}\Big)\,\Delta_{s,x_s}\,\Big(\prod_{t=1}^{s-1} M_{t,x_t}\Big).
$$

### 5.3. 长度依赖与几何放大

望远镜展开中的误差累积由传播常数 $\kappa_{p,t}$ 控制。

##### 定义 5.4（几何放大因子 $G_L$）

定义几何因子 $G_L(\kappa) = \sum_{t=0}^{L-1}\kappa^t$。
*   若 $\kappa>1$（扩张），$G_L(\kappa)=\Theta(\kappa^L)$。
*   若 $\kappa=1$（非扩张），$G_L(\kappa)=L$。
*   若 $\kappa<1$（收缩），$G_L(\kappa)\le (1-\kappa)^{-1}$（有界）。

##### 定理 5.5（扰动传播的稳健上界）

令 $C_{P,S}$ 为包含边界向量范数和矩阵维度 $\sqrt{mn}$ 的常数。

##### (A) 一般谱范数上界

对引理 5.3 应用谱范数的次乘性，得到普适界：
$$
\boxed{\;
\|H_p-\widetilde H_p\|_2\ \le\ C_{P,S}\,
\sum_{s=1}^{L}\epsilon_p(s)\!\!\prod_{t\ne s}\kappa_{p,t}
\ \le\ 
C_{P,S}\,\kappa_p^{\,L-1}\!\sum_{t=1}^{L}\epsilon_p(t).
\;}
$$

在 $\kappa_p>1$ 时，该界可能随 $L$ 指数增长。

##### (B) 可收缩范数下的精炼界

若存在某诱导范数 $\|\cdot\|_\bullet$（例如在非负/次随机锥内的 $L_1$ 或 $L_\infty$ 范数，见 §8.2），使得前缀乘积非扩张（$\|\prod_{t=1}^{s-1}M_{t,x_t}\|_\bullet\le 1$），且 $\|\widetilde M_{t,x_t}\|_\bullet\le \kappa_{p,t}^{(\bullet)}$。定义时变几何因子 $G_{1:L}(\kappa^{(\bullet)}):=\sum_{s=1}^{L}\prod_{t=s+1}^{L}\kappa_{p,t}^{(\bullet)}$。则：
$$
\boxed{\;
\|H_p-\widetilde H_p\|_2
\ \le\ C_{P,S}^{(\bullet)}\,
\Big(\sum_{t=1}^{L}\epsilon_p^{(\bullet)}(t)\Big)\,
G_{1:L}\big(\kappa^{(\bullet)}\big).
\;}
$$

（$C_{P,S}^{(\bullet)}$ 包含范数等价常数）。

**关键特例（$O(L)$ 依赖）：** 若 $\kappa_{p,t}^{(\bullet)}\le 1$，则 $G_{1:L}\le L$。此时，长度依赖性被控制为线性 $O(L)$，避免了指数放大。

---

## 第6章：可辨识性、条件数与最小实现

本章探讨 Hankel 矩阵的谱性质如何决定底层 WFA 表示的结构唯一性（可辨识性）和恢复的数值稳定性（条件数）。我们建立了最小奇异值的下界判据，并回顾了最小实现理论和规范化技术。

### 6.1. 稳定性判据：限制 Gram 下界

从 Hankel 矩阵 $H$ 稳定恢复其最小实现依赖于其最小非零奇异值 $\sigma_r(H)$。我们利用可观测/可控制分解来建立这个下界。

**设定：** $H=O_P C_S$，$\operatorname{rank}(H)=r$。令 $k=\operatorname{rank}(C_S)$，并取 $U$ 为 $\mathrm{col}(C_S)$ 的正交基 ($U^\dagger U=I_k$)。定义**限制 Gram 矩阵**：
$$
\mathcal O_P:=U^\dagger O_P^\dagger O_P\,U,\qquad
\mathcal C_S:=U^\dagger C_S C_S^\dagger U\quad(\in\mathbb C^{k\times k}).
$$

##### 定理 6.1（限制-Gram 下界）

在上述设定下，Hankel 矩阵的第 $r$ 个奇异值满足：

$$
\boxed{\quad
\sigma_r(H)\ \ge\ \sqrt{\lambda_{\min}(\mathcal O_P)}\;\sqrt{\lambda_{r}(\mathcal C_S)}\ .
\quad}
$$

若 $\operatorname{rank}(C_S)=r$，则 $\sigma_r(H) \ge \sqrt{\lambda_{\min}(\mathcal O_P)}\sqrt{\lambda_{\min}(\mathcal C_S)}$。

**证明概要：** 利用 $H^\dagger H = (U^\dagger C_S)^\dagger \mathcal{O}_P (U^\dagger C_S)$ 和 Loewner 序 $\mathcal O_P\succeq \lambda_{\min}(\mathcal O_P)I$，可得 $H^\dagger H \succeq \lambda_{\min}(\mathcal O_P) (U^\dagger C_S)^\dagger(U^\dagger C_S)$。对两边取第 $r$ 个特征值即得结论。

该定理表明，为了保证稳定性（大的 $\sigma_r(H)$），必须选择能够使限制 Gram 矩阵 $\mathcal O_P$ 和 $\mathcal C_S$ 充分良态（well-conditioned）的前缀集 $P$ 和后缀集 $S$。

##### 命题 6.2（选集优化与 Log-det 子模性）

为系统地选择 $P$（$S$ 同理），我们考虑优化 Gram 矩阵的体积（D-optimality）。定义目标函数（$\lambda>0$）：

$$
F_P(\mathcal S)=\log\det\!\Big(I+\lambda^{-1}\!\!\sum_{u\in\mathcal S}\ell_p(u)\ell_p(u)^\dagger\Big).
$$

$F_P$ 关于集合 $\mathcal S$ 是**单调且子模的**。因此，在基数约束下，贪心算法可达到 $(1-1/e)$ 近似最优。最大化 $F_P$ 单调地提升了 $\lambda_{\min}(\mathcal{O}_P)$ 的保守下界，从而改善 $\sigma_r(H)$ 的下界。

### 6.2. 最小实现与规范化

我们回顾 WFA 实现理论的关键结果（详见 §3.2）。

##### 定理 6.3（最小实现与唯一性）

（无限）Hankel 矩阵 $H$ 的秩 $r$ 等于最小线性表示的维度。该最小表示在相似变换下是唯一的。对于有限长度 $L$，必须使用块-Hankel $H^{(\le L)}$ 的秩来定义最小维度。

在谱学习中，我们从经验 Hankel $\widehat H$ 恢复表示。为了消除相似变换的不确定性并确保数值稳定性，我们进行规范化。

##### 命题 6.4（恒等校准/白化）

设 $\widehat H$ 的秩-$r$ 截断 SVD 为 $\widehat H \approx U_r\Sigma_r V_r^\dagger$。通过构造适当的可逆矩阵 $W_L, W_R$（基于 $U_r, V_r, \Sigma_r$，见 §3.3 定理 3.11B），我们可以在秩-$r$ 子空间上实现精确的白化：$W_L\,\widehat H\,W_R\approx I_r$。

定义校准后的 **WFA 有效转移矩阵** $\widehat B_\sigma:=W_L,\widehat H_\sigma,W_R$（$\widehat H_\sigma$ 为按后缀首字母划分的子块），则它们按构造满足**恒等和约束**：

$$
\boxed{\quad \sum_{\sigma\in\Sigma}\widehat B_\sigma\approx I_r.\quad}
$$

这建立了一个数据驱动的规范坐标系。这里的 $\widehat B_\sigma$ 仅是在 Hankel 子空间上与真实分布等价的表示，一般不应与物理转移算子 $B_\sigma$ 混同。

### 6.3. 条件数与稳定性分析

我们分析估计误差如何通过条件数放大。定义**相干度** $\mu\in[0,1]$ 为 $H$ 的最大行/列边缘概率和，它在统计分析中控制方差。

令 $\Delta:=\|\widehat H-H\|_2$ 为统计误差，$\gamma:=\sigma_r(H)>0$ 为真 Hankel 的谱隙。

##### 引理 6.5（真白化坐标下的稳定性）

存在一个由真值 $H$ 定义的“真白化坐标系”。在该固定坐标系下，估计得到的算子块 $\breve B_\sigma$ 与真值算子块 $B_\sigma^\star$ 之间的误差满足一个稳健的界：

$$
\boxed{\quad
\|\breve B_\sigma-B_\sigma^\star\|_2
\ \le\ \frac{\Delta}{\gamma}\qquad (\forall\,\sigma\in\Sigma).
\quad}
$$

**证明概要：** 该界直接由算子范数的次乘性和白化算子的范数界（由 $1/\gamma$ 控制）得出，不依赖复杂的子空间扰动分析。

该引理是端到端误差分析（第 11 章）的基础，它表明学习的稳定性直接由信噪比 $\Delta/\gamma$ 决定。

---

## 第7章：下界、反例与典型性

本章探讨 Hankel 矩阵秩的典型行为，构造导致劣条件的反例，并分析谱学习方法的样本复杂度依赖性。

### 7.1. 典型满秩与结构假设

与低秩假设相反，随机参数化的 MPS 通常导致满秩的 Hankel 矩阵。

##### 定理 7.1（典型满秩）

设 MPS 键维为 $D$。若模型参数的分布对于参数空间的 Lebesgue 测度（或 Haar 测度）是**绝对连续**的，则对于足够大的前缀/后缀集 $P, S$（$|P|,|S|\ge D^2$），有：

$$
\Pr\!\big[\operatorname{rank}H_p(P,S)=D^2\big]=1.
$$

**说明：** 秩亏（Rank deficiency）对应于参数空间中一个代数簇（行列式多项式的零点集）。由于存在满秩实例（多项式非零），该零点集测度为零。因此，高纠缠或随机电路通常产生满秩 $H_p$。这强调了低秩 Hankel 假设是一种强有力的**结构性约束**（例如低纠缠），而非典型性质。

### 7.2. 秩亏与劣条件的构造性反例

我们构造特定的 MPS 实例来展示 Hankel 矩阵如何变得秩亏或劣条件。以下示例采用二元字母表，且省略归一化常数。

##### 7.2A（精确秩-1 构造）

取 $D=2$，对角 MPS：$A(0)=\mathrm{diag}(1,\eta)$, $A(1)=\mathrm{diag}(\eta,1)$ ($0<\eta<1$)，边界 $\alpha=\beta=e_1$。则 $H_a(u,v)=\eta^{\#1(u)+\#1(v)}$。因此 $H_p(u,v)$ 是两个向量的外积，$\operatorname{rank}(H_p)=1$。

##### 7.2B（秩-3 与近奇异分析）

取边界 $\alpha=\beta=[1,\ c]^\top$ ($0<c\le1$)。构造 $H_a(u,v)=A(u,v)+c^2 C(u,v)$，其中 $A, C$ 分别是基于 $\#1(x)$ 和 $\#0(x)$ 的秩-1 矩阵（如 7.2A）。则 $H_p=(A+c^2C)^{\circ 2}$（逐元素平方）是三个秩-1 矩阵的和，故 $\operatorname{rank}(H_p)\le 3$。

**谱分析（概要）：** 通过详细的谱分析（利用 Hadamard 积性质和 Gram 矩阵特征值），可以得到奇异值的界限。令 $E=2c^2(A\circ C)$ 为交叉项。

$$
\boxed{\ \ \sigma_3(H_p)\ \le\ \|E\|_2\ =\ 2c^2(\sqrt2\,\eta)^L\ .\ }
$$

同时，$\sigma_2(H_p)$ 存在一个下界（详见原文），其主项随 $L$ 呈 $(1+\eta^4)^{L/2}$ 级增长。

**结论：** 当 $\eta$ 较小时，$\sigma_3(H_p)$ 指数衰减，导致条件数 $\kappa(H_p)$ 很大（劣条件）。然而，只要 $c>0$ 且 $\eta<1$，$\sigma_2(H_p)$ 仍然远离零；真正的近奇异（$\sigma_2(H_p)\approx 0$）仅在 $c\to0$ 或 $\eta\to1$ 时发生。

### 7.3. 谱学习的样本复杂度依赖

基于 Hankel 矩阵的谱学习方法（涉及白化和反演）的样本复杂度 $N$ 强烈依赖于矩阵的谱性质。记统计误差 $\Delta=\|\widehat H-H\|_2 \approx \sqrt{\mu/N}$（$\mu$ 为相干度）。

##### 稳定性门槛（必要条件）

为了稳定地反演（或白化），统计噪声必须小于谱隙：$\Delta \ll \sigma_{\min}(H_p)$。这要求：
$$
\boxed{\quad N\ \gtrsim\ \frac{\mu}{\sigma_{\min}(H_p)^2}\ .\quad}
$$

##### 精度门槛（充分条件）

为了达到点态精度 $\varepsilon$，根据端到端误差传播分析（第 11 章），样本复杂度受长度放大因子 $G_L(\kappa_B)$ 和条件数（由谱隙 gap 和白化正则化 $\gamma_\lambda$ 控制）的共同影响：
$$
\boxed{\quad
N\ \gtrsim\ 
\frac{\mu\,G_L(\kappa_B)^2}{\varepsilon^2}\,
\Big(\tfrac{1}{\mathrm{gap}}+\tfrac{1}{\gamma_\lambda}\Big)^{\!2}.
\quad}
$$

劣条件的 Hankel 矩阵（小 $\sigma_{\min}$ 或大 $G_L$）会显著增加通过谱方法重建整个分布所需的样本量。

### 7.4. 无结构信息论下界

作为基线，若不利用任何结构（如低秩性），学习长度为 $L$ 的任意分布至 TV 误差 $\varepsilon$ 的 Minimax 样本复杂度为：

$$
\boxed{\quad N\ \ge\ \Omega\!\big(d^L/\varepsilon^2\big).\quad}
$$

这表明，要克服维数灾难，必须利用 QCBM/MPS 提供的低秩 Hankel 结构。

---

## 第8章：稳健性与扩展策略

本章探讨模型在扰动下的稳健性，并介绍两种关键的扩展策略以改善学习性能：利用可收缩锥实现线性长度依赖，以及通过多视角 Hankel 联合分析提升稳定性。

### 8.1. 扰动稳健性与误差传递

我们分析一般模型扰动（例如门噪声，参数误差 $\|A_t(\sigma)-\widetilde A_t(\sigma)\|_2\le \varepsilon_t$）如何影响概率 Hankel 矩阵 $H_p$。分析框架基于第 5 章的望远镜展开和传播常数 $\kappa_p$。

##### 定理 8.1（端到端噪声传递界）

令 $\kappa=\max_{t,\sigma}\|A_t(\sigma)\|_2$。$C_{P,S}$ 和 $C_{P,S}^{(\bullet)}$ 为常数（依赖于维度和边界向量范数）。

##### (A) 普适谱范数界（无收缩假设）

$$
\boxed{\ 
\|H_p-\widetilde H_p\|_2
\ \le\ 
C_{P,S}\,\kappa_p^{\,L-1}\!
\sum_{t=1}^{L}\big(2\kappa\,\varepsilon_t+\varepsilon_t^{2}\big).
\ }
$$

##### (B) 可收缩范数界

若存在诱导范数 $\|\cdot\|_\bullet$ 使得前缀乘积非扩张且 $\|M_{t,\sigma}\|_\bullet, \|\widetilde M_{t,\sigma}\|_\bullet\le \kappa_{p,t}^{(\bullet)}$（见 §5.3），则：
$$
\boxed{\ 
\|H_p-\widetilde H_p\|_2
\ \le\
C_{P,S}^{(\bullet)}\,
\Big(\sum_{t=1}^{L}\big(2\kappa\,\varepsilon_t+\varepsilon_t^{2}\big)\Big)\,
G_{1:L}\!\big(\kappa^{(\bullet)}\big).
\ }
$$

若 $\kappa_{p,t}^{(\bullet)}\le 1$，则几何因子 $G_{1:L}\le L$，长度依赖为线性。

##### 推论 8.2（截断与噪声的合并界）

若同时存在逐割截断误差（尾能量 $\{\epsilon_t\}$）和门扰动，总误差为两部分之和。例如，在可收缩范数 (B) 下：

$$
\|H_p-\widehat H_p\|_2
\ \le\
2\Big(\textstyle\sum_{t}\epsilon_t^{2}\Big)^{\!1/2}
\ +\
C_{P,S}^{(\bullet)}\!\Big(\sum_{t}\big(2\kappa\,\varepsilon_t+\varepsilon_t^{2}\big)\Big)\,G_{1:L}\!\big(\kappa^{(\bullet)}\big).
$$

### 8.2. 可收缩锥与 $O(L)$ 长度依赖

在特定结构约束下，可以保证系统是非扩张的，从而将长度依赖性从指数级降为线性 $O(L)$。这对应于定理 8.1(B) 中 $\kappa^{(\bullet)}\le 1$ 的情形。

##### 定义 8.3（非负/次随机锥）

定义行（列）非负且行（列）次随机锥，例如：
$\mathcal K_{\rm row}=\{\{B_\sigma\}:\ B_\sigma\ge 0,\ \sum_{\sigma}B_\sigma\mathbf{1}\le \mathbf{1}\}$。

##### 定理 8.4（非扩张性与 $O(L)$ 界）

若 $\{B_\sigma\}\in\mathcal K_{\rm row}$，则采用诱导范数 $\|\cdot\|_\bullet:=\|\cdot\|_\infty$（最大行和）。若 $\{B_\sigma\}\in\mathcal K_{\rm col}$，则采用 $\|\cdot\|_\bullet:=\|\cdot\|_1$（最大列和）。在匹配的范数下：

$$
\boxed{\ \ \max_{\sigma}\|B_\sigma\|_\bullet\ \le\ 1,\qquad
\Big\|\prod_{t=1}^L B_{x_t}\Big\|_\bullet\ \le\ 1\quad(\forall\,x\in\Sigma^L).\ \ }
$$

因此，几何放大因子 $G_L(\kappa_B^{(\bullet)})\le L$。

**备注：** 非负性 $B_\sigma\ge 0$ 是保证单个算子范数 $\le 1$ 的关键。需要强调的是，对于一般的 QCBM，$B_\sigma=A(\sigma)\otimes\overline{A(\sigma)}$ 通常是复值且未必非负/次随机，因此上述锥约束应理解为对更广泛 WFA/概率模型的结构性假设。我们在 QCBM 场景中使用 $\mathcal K_{\rm row},\mathcal K_{\rm col}$ 时，是将从数据学得的 $\{\widehat B_\sigma\}$ 投影到该锥中，作为一种稳健化与正则化的近似模型，而非声称真实 QCBM 本身就满足这些约束。

##### 命题 8.5（投影误差分析）

在实践中，我们将估计 $\{\widehat B_\sigma\}$ 投影到锥 $\mathcal K$ 上得到 $\{\widehat B_\sigma^{\rm proj}\}$。令投影误差 $\delta:=\max_{\sigma}\|\widehat B_\sigma-\widehat B_\sigma^{\rm proj}\|_\bullet$。在小误差区域（设 $L\delta\le c$），投影引入的点态误差满足：

$$
\big|\alpha^\top\big(\textstyle\prod_{t=1}^L\widehat B_{x_t}^{\rm proj}-\prod_{t=1}^L\widehat B_{x_t}\big)\beta\big|
\ \le\ C(c)\,\|\alpha\|_{\bullet,*}\,\|\beta\|_{\bullet}\,L\,\delta.
$$

这表明投影仅引入 $O(L\delta)$ 的误差，不改变收敛阶（通常 $\delta=O(1/\sqrt N)$）。

### 8.3. 多视角 Hankel 联合分析

单一视角的 Hankel 矩阵可能劣条件。联合多个视角（不同长度 $L_k$ 或切分点 $t_{\star,k}$）可以显著提升稳定性和可辨识性。

#### 8.3.1 统一坐标与联合结构

**核心思想：** 所有视角的 Hankel 矩阵 $H^{(k)}$ 均源自同一个最小 WFA 表示 $(i,\{B_\sigma\},f)$。我们可以通过联合白化和恒等校准（见 §6.2），将所有视角转换到一个公共的 $r$ 维坐标系中，使得 $H^{(k)}=O^{(k)}C^{(k)}$，且在该坐标系下满足 $\sum_\sigma B_\sigma = I_r$。

##### 定义 8.6（联合 Hankel 矩阵）

定义联合可观测和可控制矩阵为块堆叠形式：

$$
\mathcal O_{\rm joint}:=
\begin{bmatrix}
O^{(1)}\\\vdots\\O^{(K)}
\end{bmatrix},\qquad
\mathcal C_{\rm joint}:=
\begin{bmatrix}
C^{(1)}&\cdots&C^{(K)}
\end{bmatrix}.
$$

联合 Hankel 矩阵定义为 $H_{\rm joint}:=\mathcal O_{\rm joint}\,\mathcal C_{\rm joint}$，其秩 $\le r$。

#### 8.3.2 稳定性提升的理论保证

联合多视角可以严格提升最小奇异值 $\sigma_r(H_{\rm joint})$ 的下界。

##### 定理 8.7（联合视角的 $\sigma_r$ 下界）

##### (A) 乘法型下界

$$
\boxed{
\ \sigma_r(H_{\rm joint})
\ \ge\ \sigma_r(\mathcal O_{\rm joint})\ \sigma_r(\mathcal C_{\rm joint}).
}
$$

##### (B) Gram 分解下界（累积提升）

联合 Gram 矩阵满足 $\mathcal O_{\rm joint}^\top\mathcal O_{\rm joint} = \sum_k O^{(k)\top}O^{(k)}$。利用 PSD 矩阵和的性质 $\lambda_{\min}(\sum A_k)\ge \sum \lambda_{\min}(A_k)$，我们得到：
$$
\lambda_{\min}(\mathcal O_{\rm joint}^\top\mathcal O_{\rm joint})
\ \ge\ \sum_k \lambda_{\min}(O^{(k)\top}O^{(k)}).
$$

结合 (A) 得出：

$$
\boxed{
\ \sigma_r(H_{\rm joint})\ \ge\
\sqrt{\Big(\sum_k \lambda_{\min}(O^{(k)\top}O^{(k)})\Big)
\Big(\sum_k \lambda_{\min}(C^{(k)}C^{(k)\top})\Big)}\ .
}
$$

该定理证明了多视角联合通过累积各视角的 Gram 信息，系统地提升了稳定性下界。

##### 推论 8.8（秩恢复与优化）

1.  若任一视角 $k_0$ 满足 $\operatorname{rank}(O^{(k_0)})=\operatorname{rank}(C^{(k_0)})=r$，则 $H_{\rm joint}$ 必然满秩 $r$。
2.  多视角选集可以通过最大化联合 Log-det 目标函数（§6.1）进行优化，该目标函数保持子模性，保证贪心算法的有效性，并单调提升 $\sigma_r(H_{\rm joint})$ 的下界。

**兼容性：** 多视角联合与 §8.2 的可收缩锥分析完全兼容。在联合坐标系下应用非负/次随机投影，仍然保证 $O(L)$ 的长度依赖性。

---

# ==Part III：统计学习理论==

## 第9章：Hankel 估计的集中不等式

本章分析经验 Hankel 矩阵 $\widehat H$ 相对于其期望 $H$ 的集中性质，为后续的泛化和误差分析提供基础。我们考虑独立（one-shot）和相关（滑窗）两种采样模型。

**统一设定：** 固定长度 $L$ 和切分点 $t_\star$。$H=H_p(P,S)\in\mathbb R^{m\times n}$。我们引入关键的方差控制参数：**相干度（Coherence）** $\mu\in[0,1]$，定义为 $H$ 的最大行/列边缘概率和：
$$
\mu:=\max\Big\{\max_{u\in P}\|H(u,:)\|_1,\ \max_{v\in S}\|H(:,v)\|_1\Big\}.
$$

### 9.1. One-shot 采样：矩阵 Bernstein 界

在 one-shot 模型中，我们有 $N$ 个独立样本 $x^{(i)}\sim p$。经验 Hankel $\widehat H=\frac1N\sum_{i=1}^N Z_i$，其中 $Z_i$ 是对应于第 $i$ 个样本的指示矩阵（在 $(u^{(i)},v^{(i)})$ 处为 1，其余为 0）。

##### 定理 9.1（矩阵 Bernstein 不等式）

矩阵 $Z_i$ 满足谱范数有界（$\|Z_i\|_2=1$），且其方差参数（行/列方差的谱范数最大值）被相干度 $\mu$ 控制。应用矩阵 Bernstein 不等式，存在绝对常数 $C_1,C_2>0$，对任意 $\delta\in(0,1)$，以概率至少 $1-\delta$：

$$
\boxed{\quad
\|\widehat H-H\|_2\ \le\ 
C_1\sqrt{\frac{\mu\,\log\!\big((m+n)/\delta\big)}{N}}
\ +\ 
C_2\,\frac{\log\!\big((m+n)/\delta\big)}{N}\ .
\quad}
$$

##### 引理 9.2（掩膜不增性）

对任意对角投影矩阵（列掩膜）$\Pi$，有 $\|\widehat H\Pi-H\Pi\|_2\le \|\widehat H-H\|_2$。这意味着对子块 $H_\sigma$ 的估计误差自动被控制，无需额外的联合界代价（如 $\log d$ 因子）。

### 9.2. 滑窗采样：处理依赖性

在滑窗模型中，我们从 $N$ 条长序列（长度 $T\ge L$）中提取 $K=T-L+1$ 个窗口。总样本量为 $NK$，但窗口之间存在相关性。我们利用混合假设或鞅方法来处理这种依赖。

##### 定理 9.3（矩阵 Freedman：鞅依赖版）

将窗口序列构造成矩阵鞅差序列。假设其条件方差过程的谱范数被 $\sigma^2\le \mu\cdot \eta$ 控制，其中 $\eta\ge1$ 是**依赖膨胀因子**（可由混合系数如 $\beta$-mixing 界定）。则以概率至少 $1-\delta$：

$$
\|\widehat H-H\|_2\ \le\ 
C\left(
\sqrt{\frac{\mu\,\eta\,\log((m+n)/\delta)}{N K}}
+\frac{\log((m+n)/\delta)}{N K}
\right).
$$

**解释：** 若系统混合迅速，则 $\eta$ 有界。此时，有效样本量可以视为 $N_{\rm eff} \approx NK/\eta$。若不假设混合性，则只能得到保守的 $O(1/\sqrt{N})$ 界。

### 9.3. 缓解高相干度：加权与稳健化

当分布高度不均匀时，相干度 $\mu$ 可能接近 1，导致方差界变大。可以通过以下策略缓解：

1.  **边缘预白化（Reweighting）**：使用经验边缘分布的逆平方根作为权重（例如 $w_u\propto 1/\sqrt{\widehat r_u+\lambda}$）来预条件化 $\widehat H$（$W \widehat H W'$），从而降低有效相干度。
2.  **重要性加权（Importance Sampling）**：若可控制采样分布 $\pi(u,v)$，可使用 Horvitz–Thompson 估计器。实践中可用边缘分布近似最优采样 $\pi\propto H$。
3.  **稳健估计（Robustification）**：采用谱几何中值（Median-of-Means）等稳健估计量，可以在存在重尾噪声或污染时保持 $\sqrt{\mu/N}$ 的收敛率。

---

## 第10章　泛化与复杂度分析

本章分析学习 Hankel 矩阵的泛化能力。我们利用 Rademacher 复杂度推导依赖于核范数和有效秩的结构化界，并引入 PAC-Bayes 和互信息界作为补充视角。

**设定：** 我们考虑在 one-shot 采样下，使用 1-Lipschitz（且有界）的条目损失 $\ell$ 进行学习。主要关注的假设空间是核范数球：$\mathcal F_*=\{M\in\mathbb R^{m\times n}:\ \|M\|_*\le \tau_*\}$。

### 10.1 核范数复杂度与 Rademacher 界

泛化能力的核心度量是 Rademacher 复杂度 $\mathfrak R_N(\mathcal F_*)$。

##### 定理 10.1（核范数球的 Rademacher 复杂度）

令 $\mu$ 为 Hankel 矩阵的相干度（§9）。核范数球 $\mathcal F_*$ 的 Rademacher 复杂度满足：

$$
\mathfrak R_N(\mathcal F_*)\ \le\ C\,\tau_*\,\sqrt{\frac{\mu\,\log(m+n)}{N}}
\quad \left( + \text{低阶项 } O\left(\tau_*\tfrac{\log(m+n)}{N}\right)\right).
$$

**证明概要：** 利用核范数与谱范数的对偶性，$\mathfrak R_N(\mathcal F_*)$ 等价于 $\tau_*$ 乘以经验过程谱范数的期望。该期望通过矩阵集中不等式（如矩阵 Bernstein 或非交换 Khintchine）界定，其中方差由 $\mu$ 控制。

##### 推论 10.2（泛化间隙）

对于 1-Lipschitz 损失，泛化间隙被 $2\mathfrak R_N(\mathcal F_*)$ 控制。以概率至少 $1-\delta$：

$$
\text{gen gap}\ \le\ 2C\,\tau_*\,\sqrt{\frac{\mu\,\log(m+n)}{N}}\ +\ C'\,\sqrt{\frac{\log(1/\delta)}{N}}.
$$

### 10.2 结构化泛化界：有效秩的作用

我们将 Hankel 矩阵的结构（近低秩）转化为核范数约束，以应用上述界限。

##### 定义 10.3（有效秩）

定义矩阵 $M$ 的**有效秩**为 $r_{\rm eff}(M) := \|M\|_*^2/\|M\|_F^2$。它满足 $1\le r_{\rm eff}(M)\le \operatorname{rank}(M)$，并量化了奇异值分布的均匀性。关键关系式：$\|M\|_* = \sqrt{r_{\rm eff}(M)}\|M\|_F$。

##### 定理 10.4（目标依赖的统一收敛界）

假设目标 Hankel 矩阵 $H$ 满足结构约束：Frobenius 范数有界 $\|H\|_F\le\tau_F$ 且有效秩有界 $r_{\rm eff}(H)\le r$。这蕴含 $\|H\|_*\le \sqrt{r}\tau_F$。

取 $\tau_*=\sqrt{r}\tau_F$。若使用经验风险最小化（ERM）或核范数正则化在 $\mathcal F_*$ 中学习得到 $\widehat M$，则其超额风险满足：

$$
\mathbb E\big[\mathcal L(\widehat M)-\mathcal L(H)\big]
\ \le\ 
C\,\sqrt r\,\tau_F\,\sqrt{\frac{\mu\,\log(m+n)}{N}}
\ +\ O\!\Big(\sqrt r\,\tau_F\,\frac{\log(m+n)}{N}\Big).
$$

**解释：** 该界限清晰地展示了泛化如何依赖于系统的能量（$\tau_F$）、复杂度（$r$）和采样难度（$\mu$）。在低有效秩时，样本复杂度显著优于无结构下界。

### 10.3 信息论视角：PAC-Bayes 与互信息

我们提供与结构无关的泛化界，这些界限通过信息论工具（KL 散度、互信息）来衡量模型的复杂度或算法的稳定性。假设损失有界于 $[0,1]$。

##### 定理 10.5（PAC-Bayes 界）

令 $P$ 为先验，$Q_S$ 为数据依赖的后验分布。随机预测器（从 $Q_S$ 采样）的泛化间隙满足（以高概率）：

$$
\Big|\mathrm{gen\ gap}(Q_S)\Big|
\ \le\ 
C\,\sqrt{\frac{\mathrm{KL}(Q_S\|P)+\log(1/\delta)}{N}}.
$$

**低秩参数化的影响：** 若采用低秩分解 $M=UV^\top$（秩 $r$），参数维度为 $(m+n)r$。在适当的高斯先验和有界范数后验下，$\mathrm{KL}(Q_S\|P) = O((m+n)r)$。这导致泛化界为 $O(\sqrt{(m+n)r/N})$，体现了低秩参数化带来的维数约减优势。

##### 命题 10.6（互信息界）

令 $\mathcal A(S)$ 为学习算法的输出。泛化间隙的期望满足：

$$
\mathbb E\big[\mathrm{gen\ gap}\big]
\ \le\ 
C\,\sqrt{\frac{I(\mathcal A(S);S)}{N}}.
$$

该界通过算法输出与训练集之间的互信息来衡量复杂度，适用于分析正则化、压缩或噪声注入等技术的效果。

---

## 第11章：端到端误差与样本复杂度

本章整合结构理论（稳定性）和统计分析（集中性），推导从 Hankel 估计误差 $\Delta:=\|\widehat H-H\|_2$ 到最终点态分布误差 $\sup_{|x|=L}|\widehat p(x)-p(x)|$ 的端到端保证，并确定样本复杂度。

**核心参数：** $\gamma:=\sigma_r(H)>0$（谱隙/条件数），$\mu$（相干度），$\kappa_B$（传播常数）。

### 11.1. 误差传播分析

我们利用第 6 章建立的“真白化坐标系”分析误差传播。在该坐标系下，白化算子满足 $\|W_L\|_2\|W_R\|_2 \le 1/\gamma$。

##### 定理 11.1（算子误差界定）

统计误差 $\Delta$ 传递到 WFA 转移算子的误差 $\varepsilon_B:=\max_{\sigma}\|\widehat B_\sigma-B_\sigma\|_2$ 满足：

$$
\boxed{
\ \ \varepsilon_B\ \le\ \frac{\Delta}{\gamma}\ .
}
$$

**证明概要：** 由 $\widehat B_\sigma-B_\sigma=W_L(\widehat H_\sigma-H_\sigma)W_R$，利用谱范数次乘性和掩膜不增性（$\|\widehat H_\sigma-H_\sigma\|_2\le \Delta$）即得。

误差随序列长度 $L$ 的传播由传播常数 $\kappa_B$ 控制。

##### 定理 11.2（点态误差传播：一般情形）

令 $C_2$ 为依赖于边界向量范数的常数。对任意 $x\in\Sigma^L$：

$$
\boxed{
\ |\widehat p(x)-p(x)|\ \le\ 
C_2\,\varepsilon_B\;L\,\kappa_B^{L-1}
\ \le\ 
C_2\,\frac{\Delta}{\gamma}\,L\,\kappa_B^{L-1}.
}
$$

**证明概要：** 利用望远镜展开（§5.2）分析乘积 $\prod \widehat B_{x_t} - \prod B_{x_t}$ 的范数。长度依赖因子为 $L\kappa_B^{L-1}$（或更精细的几何因子 $G_L(\kappa_B)$）。

### 11.2. 可收缩锥下的 $O(L)$ 界

若 $\kappa_B>1$，误差可能指数放大。引入结构假设可以改善长度依赖性。

##### 假设 11.3（可收缩锥）

假设在真白化坐标下，$\{B_\sigma, \widehat B_\sigma\}$ 属于非负/次随机锥（§8.2）。此时存在诱导范数 $\|\cdot\|_\bullet$ 使得系统非扩张（$\kappa_B^{(\bullet)}\le 1$）。

##### 定理 11.4（点态误差传播：可收缩情形）

在假设 11.3 下，长度依赖性降为线性 $O(L)$。存在常数 $C'$（包含范数等价常数）：

$$
\boxed{
\ |\widehat p(x)-p(x)|\ \le\ 
C'\,\frac{\Delta}{\gamma}\,L.
}
$$

**证明概要：** 在 $\|\cdot\|_\bullet$ 下重做望远镜展开。由于非扩张性，累积因子为 $L$。

### 11.3. 端到端界与样本复杂度

结合第 9 章的矩阵 Bernstein 界（$\Delta = \tilde O(\sqrt{\mu/N})$），我们得到最终保证。

##### 定理 11.5（端到端高概率界）

存在常数 $C>0$，在 one-shot 采样下，以概率至少 $1-\delta$：

$$
\sup_{|x|=L}|\widehat p(x)-p(x)|\ \le\ 
\frac{C\, F(L)}{\gamma}
\left(
\sqrt{\frac{\mu\,\log((m+n)/\delta)}{N}}
+\frac{\log((m+n)/\delta)}{N}
\right),
$$

其中长度放大因子 $F(L)$ 分别为：
*   **一般情形：** $F(L) = L\,\kappa_B^{L-1}$。
*   **可收缩锥（假设 11.3）：** $F(L) = L$。

##### 命题 11.6（样本复杂度）

在**可收缩锥假设**下，为达到目标点态误差 $\varepsilon>0$，所需的样本量 $N$ 满足（忽略对数因子 $\tilde O(\cdot)$）：

$$
\boxed{
\ N\ =\ \tilde O\left(
\frac{L^2\,\mu}{\gamma^2\,\varepsilon^2}
\right).
}
$$

若采用满足混合条件的滑窗采样，则 $N$ 可替换为有效样本量 $N_{\rm eff}$。

### 11.4. 信息论下界与差距分析

我们提供 Minimax 下界以评估上界的紧性。

##### 定理 11.7（TV 距离的 Minimax 下界）

在非负锥和白化坐标（非扩张，$\kappa_B\le 1$）的设定下，学习长度为 $L$ 的分布至 TV 误差 $\varepsilon$ 的 Minimax 样本复杂度满足：

$$
\boxed{\quad N\ =\ \Omega(1/\varepsilon^2).\quad}
$$

**证明概要：** 利用 Le Cam 方法和 Pinsker 不等式构造不可区分实例。在非扩张设定下，适当构造可证明该下界与 $L$ 无关。

**结论：** 在可收缩情形下，我们的上界 $\tilde O(L^2/\varepsilon^2)$ 与下界 $\Omega(1/\varepsilon^2)$ 之间存在关于 $L$ 的多项式差距。这表明当前的上界在长度依赖性上可能是保守的。

---

# ==Part Ⅳ：拓展与统一视角==

## 第12章：混态、POVM 与量子通道

本章将纯态 QCBM 的 Hankel 框架推广到更一般的量子序列模型，包括混态（Mixed States）、广义测量（POVM）和由量子通道驱动的动力学，并分析高级量子访问技术对样本复杂度的影响。

### 12.1. 混态与 POVM 的 Hankel 结构

我们考虑由初始密度矩阵 $\rho_0$ 和 POVM $\{M_x\}$ 生成的分布 $p(x)=\mathrm{Tr}(M_x\rho_0)$。我们利用 Liouville 空间（向量化）的张量网络结构来界定其 Hankel 秩。

**设定：** 假设 $\rho_0$ 具有矩阵乘积密度算符（MPDO）表示，其向量化 $\mathrm{vec}(\rho_0)$ 对应的张量网络键维为 $\chi_\rho$。同时，假设测量 $\{M_x\}$ 由一个测量张量网络生成，其向量化键维为 $\chi_M$。

##### 定理 12.1（混态/POVM 的 Hankel 秩上界）

在上述设定下，概率 Hankel 矩阵 $H_p$ 的秩满足：

$$
\operatorname{rank}(H_p)\ \le\ \chi_\rho\,\chi_M.
$$

**证明概要：** 在 Liouville 表示中，$p(x)$ 是 $\mathrm{vec}(\rho_0)$ 和测量超算子对应张量网络的缩并。对于 $x=uv$ 的切分，跨割的有效维度至多为 $\chi_\rho\chi_M$，这构成了 $H_p$ 的双线性分解维度。

##### 特例与一致性：

1.  **可分测量：** 对于逐位点可分的 POVM（如计算基测量），$\chi_M=1$，则 $\operatorname{rank}(H_p) \le \chi_\rho$。
2.  **纯态 MPS：** 纯态 MPS（键维 $D$）满足 $\chi_\rho\le D^2$。若测量可分，则恢复 $\operatorname{rank}(H_p) \le D^2$。

截断分析（Part II）依然适用，有效秩由截断后的 $\chi_{\rho,{\rm eff}}\chi_{M,{\rm eff}}$ 界定。

### 12.2. 量子自动机与通道动力学

考虑由量子仪器（完全正 CP 映射 $\mathcal M_\sigma$）驱动的序列模型（量子自动机/隐马尔可夫模型）。总通道 $\mathcal E=\sum_\sigma \mathcal M_\sigma$ 是 CPTP（完全正且迹保持）。

$$
p(x_1\cdots x_L)=\mathrm{Tr}\big(\mathcal M_{x_L}\circ\cdots\circ \mathcal M_{x_1}(\rho_0)\big).
$$

##### Liouville 表示与 WFA 等价

在 Liouville 空间中，该模型精确对应于一个 WFA。转移矩阵 $B_\sigma$ 由 $\mathcal M_\sigma$ 的 Kraus 算子构建（$B_\sigma=\sum_k K_{\sigma,k}\otimes \overline{K_{\sigma,k}}$），边界向量为 $i^\top=\mathrm{vec}(I)^\top, f=\mathrm{vec}(\rho_0)$。

##### 定理 12.2（量子 WFA 结构）

该模型定义了一个 WFA，其 Hankel 秩受限于系统维度 $d^2$（或 MPDO 维度 $\chi$）。

##### 动力学性质概述

总转移算子 $T=\sum_\sigma B_\sigma$ 的谱性质（对应于 $\mathcal E$）控制着系统的收缩性和混合行为。CPTP 性保证 $\rho(T)=1$。若 $\mathcal E$ 是原始的（primitive），则存在谱隙 $1-\lambda_\star>0$，保证系统指数快速收敛到唯一稳态（混合）。

### 12.3. 量子访问对样本复杂度的影响

高级量子访问技术可以加速 Hankel 矩阵的估计。

##### 量子幅度估计（QAE）

QAE 可以在 $K$ 次量子查询内将概率估计的均方误差（MSE）降至 $O(1/K^2)$，提供相对于经典采样的二次加速（总资源 $O(1/\varepsilon)$ vs $O(1/\varepsilon^2)$）。

##### 定理 12.3（QAE 增强的 Hankel 集中）

在 one-shot 设定（$N$ 次独立试验）中，若每次试验使用 $K$ 轮 QAE 生成矩阵增量。则矩阵 Bernstein 界（定理 9.1）被修正为（以高概率，$b_K$ 为 QAE 偏差，通常 $O(1/K)$）：

$$
\boxed{\ 
\|\widehat H-H\|_2\ \le\ 
C_1\,\frac{1}{K}\sqrt{\frac{\mu\,\log((m+n)/\delta)}{N}}
\ +\ 
C_2\,\frac{\log((m+n)/\delta)}{N}
\ +\ b_K\ .
}
$$

**解释：** QAE 显著降低了方差项（第一项，按 $1/K$ 缩放），但由于 QAE 仅降低方差而不改变单次增量的幅度上界，由有界差分控制的项（第二项）不受影响。

##### 经典阴影（Classical Shadows）

作为补充技术，阴影通过随机测量提供了估计多个可观测量的有效方法，其复杂度由 shadow norm 控制，适用于多条目同时估计。

---

## 第13章　渐近行为与平稳极限

本章分析系统在长度 $L\to\infty$ 时的渐近行为，重点关注转移算子 $T$ 的谱性质如何决定系统的混合时间以及极限 Hankel 矩阵的结构。

### 13.1 谱隙与混合时间

我们采用量子通道（CPTP 映射 $\mathcal E$）及其 Liouville 表示（转移算子 $T$）的框架。系统的长期行为由 $T$ 的谱决定。

##### 定义 13.1（谱隙）

设 $T$ 的特征值为 $1=\lambda_1 \ge |\lambda_2| \ge \cdots$。定义次大特征值模（SLM） $\lambda_\star := |\lambda_2|$。若通道 $\mathcal E$ 是**原始的（primitive）**，则 $\lambda_\star < 1$，且存在**谱隙**：$\mathrm{gap}:=1-\lambda_\star > 0$。

##### 定理 13.2（收敛与混合）

若 $\mathcal E$ 是原始的，则存在唯一的稳态投影 $\Pi$（秩-1，对应稳态密度矩阵）。$T^t$ 指数快速收敛到 $\Pi$：

$$
\boxed{\ \ \|T^t-\Pi\|_2\ \le\ C\,t^{\nu-1}\,(1-\mathrm{gap})^{t}\qquad (t\ge 1).\ }
$$

其中 $C>0$ 是常数，$\nu\ge 1$ 取决于 $T$ 的 Jordan 块结构（若 $T$ 可对角化，例如满足详细平衡，则 $\nu=1$）。

**混合时间 $t_{\rm mix}(\varepsilon)$**（使残差 $\le \varepsilon$）与谱隙成反比：$t_{\rm mix}(\varepsilon) = O(\log(1/\varepsilon)/\mathrm{gap})$（忽略 $\nu$ 相关项）。谱隙的存在保证了长程关联的指数衰减。

### 13.2 有理级数与平稳性

##### 有理级数

由 WFA 生成的分布 $p(w)=i^\top B_w f$ 构成有理级数。其无限 Hankel 矩阵 $H_\infty$ 的秩有限（等于最小表示维度）。生成函数（Z-变换）由 $T$ 的解（resolvent）给出：$F(z)=i^\top (I - zT)^{-1} f$，在 $|z|<1$ 内解析。

##### 平稳极限

若观测来自平稳过程，对于固定的窗口长度 $L$，经验 Hankel 矩阵 $\widehat H^{(L)}$ 依概率收敛到真实值 $H^{(L)}$（遍历定理/强大数定律）。

### 13.3 极限 Hankel 结构：秩-1 退化

我们分析在强混合条件下，对长序列中间部分进行边缘化时 Hankel 矩阵的极限行为。

##### 定理 13.3（边缘化 Hankel 的秩-1 极限）

固定前缀/后缀集 $P, S$。定义**桥接（或边缘化）Hankel 矩阵**，它通过对长度为 $k$ 的中间段求和得到：

$$
H_p^{(\text{bridge},k)}(u,v):=\sum_{w\in\Sigma^k}p(uwv) = (O_P T^k C_S)(u,v).
$$

若 $\mathcal E$ 是原始的，则当 $k\to\infty$ 时，由于 $T^k\to\Pi$：

$$
H_p^{(\text{bridge},k)}(P,S)\ \xrightarrow[k\to\infty]{}\ O_P\,\Pi\,C_S.
$$

该极限矩阵的秩 $\le 1$。

**含义：** 强混合导致信息在传播过程中耗散。当对长窗口的内部进行边缘化时，Hankel 结构退化为近秩-1。这解释了为何过长的窗口可能导致数值上的劣条件，并为采用短窗口或多视角联合分析（§8.3）提供了理论依据。

---

## 第14章　观测增强与模型接口

概率 Hankel 矩阵 $H_p$ 仅依赖于 $|\psi(x)|^2$，损失了相位信息，这可能导致可辨识性受限或条件数恶化。本章探讨通过引入辅助观测来增强 Hankel 结构，并讨论该框架与核方法、张量网络（TN）的接口。

### 14.1 观测增强：相位信息与交叉矩

我们可以通过轻量修改测量方案或引入辅助统计量来构建额外的 Hankel 型矩阵，与 $H_p$ 联合分析以提升稳定性。

##### 1. 局域相位对比（Phase Contrast）

在测量前于位置 $t$ 施加局域相位门（如 $R_z(\phi)$）。测量其概率响应的导数，可以获得关于相位的线性信息：
$$
\Delta_{t}(u,v) :=\frac{d}{d\phi}\,p_\phi(uv)\Big|_{\phi=0}.
$$

$\Delta_t(u,v)$ 保持双线性结构，可视为辅助“对比 Hankel 矩阵” $H_{\Delta}$。

##### 2. 双份干涉（Interference/SWAP Test）

若能制备两份相同状态，可通过干涉（如 SWAP test）估计前缀（或后缀）态之间的内积，例如 $|\langle\ell(u),\ell(u')\rangle|^2$。这直接提供了关于可观测/可控制 Gram 矩阵的信息。

##### 3. 交叉矩（Cross-Moments）

引入辅助观测函数 $g:\Sigma^L\to\mathbb R$（例如符号函数或从经典阴影得到的线性函数），定义交叉 Hankel 矩阵：
$$
H_\times(u,v) := \mathbb E_{x\sim p}\big[\mathbf 1\{x=uv\}\cdot g(x)\big] = p(uv)g(uv).
$$

若 $g(x)$ 也是 WFA 可表示的，则 $H_\times$ 保持双线性结构（可能在扩张的高维空间中）。

##### 命题 14.1（观测增强提升稳定性）

设 $H_p=O_P C_S$。若辅助观测 $H_{\rm aux}$（如 $H_{\Delta}$ 或 $H_\times$）能被构造成共享同一因子（例如 $H_{\rm aux}=O_{\rm aux} C_S$），则可以构建联合 Hankel 矩阵 $H_{\rm joint} = [H_p^\top, H_{\rm aux}^\top]^\top = \mathcal O_{\rm joint} C_S$。

联合可观测 Gram 矩阵满足 PSD 序：

$$
\mathcal O_{\rm joint}^\dagger\mathcal O_{\rm joint}
=O_P^\dagger O_P + O_{\rm aux}^\dagger O_{\rm aux}\ \succeq\ O_P^\dagger O_P.
$$

因此，$\lambda_{\min}(\mathcal O_{\rm joint}^\dagger\mathcal O_{\rm joint}) \ge \lambda_{\min}(O_P^\dagger O_P)$。根据限制-Gram 下界（定理 6.1），这提升了 $\sigma_r(H_{\rm joint})$ 的下界，从而改善了谱学习的条件数和稳定性。

### 14.2 与核方法和张量网络的接口

Hankel 框架提供了与机器学习和物理中其他主流范式的自然连接。

##### 核化视角（Feature Map）

WFA 的嵌入向量 $\ell_p(u), r_p(v)$ 可被视为显式的有限维特征映射 $\phi_P(u), \phi_S(v)$。$H_p(u,v)$ 即为特征空间中的内积 $\langle\phi_P(u),\phi_S(v)\rangle$。这自然导出了字符串核 $k_P(u,u'), k_S(v,v')$，可用于核回归或低秩核学习（如 Nyström 方法）。

##### 张量网络（TN）接口

在 TN 视角下，$O_P$ 和 $C_S$ 对应于网络的边界张量。选集优化（如最大化 Log-det，§6.1）等价于选择信息最丰富的边界条件（最大化边界 Gram 体积）。该框架与 MPS/MPDO 的标准算法（如 DMRG 中的正交化和截断）兼容。

##### 命题 14.2（模型选择准则）

Hankel 矩阵的有效秩 $r_{\rm eff}$（§10.2）为模型选择提供了依据。

1.  **低有效秩（$r_{\rm eff} \ll m,n$）：** 显式低秩模型（WFA/谱方法）在统计和计算上高效，能以 $O(r_{\rm eff})$ 参数达到最优泛化界。
2.  **高有效秩或复杂局部结构：** 当 $D$ 很大且 $H$ 不显著低秩时，核化方法结合选集或 TN 技术可能更具优势。









深刻理解吃透这一章，然后做2件事  

1. 逐一验证每个引理/定理/文章中的关键结论/文章中的关键方法，是否都成立或者合理？并在每处标明“✅成立 / ⚠️需补强（仅涉及定理引理的表述层面的修改） / ❗潜在问题（问题更加深层次需要对算法的设计进行调整）/❌根本错误（存在最基本的学术错误）” 
2. 为这个研究评分，满分100